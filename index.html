<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>HeatMap.AI â€” Solana Momentum</title>
  <meta name="theme-color" content="#0b0f17">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <style>
    @font-face {
      font-family: 'InterVar';
      font-display: swap;
      src: local("Inter"), local("Inter var");
    }
    :root{
      --bg:#0b0f17;
      --panel:#121826;
      --panel-2:#0f1522;
      --text:#e6eefc;
      --muted:#9fb0d1;
      --hot:#ff5c5c;
      --warm:#ff9f43;
      --cool:#2ed3ea;
      --cold:#6c8cff;
      --good:#14c184;
      --bad:#ff6b6b;
      --accent:#7c5cff;
      --tile:#0e1422;
      --ring:#25324a;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
    header{
      position:sticky;top:0;z-index:5;
      background:linear-gradient(180deg,rgba(11,15,23,.95),rgba(11,15,23,.65) 60%,rgba(11,15,23,0));
      backdrop-filter: blur(6px);
      padding:14px 14px 6px 14px;border-bottom:1px solid rgba(255,255,255,.06)
    }
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .logo{font-weight:800;letter-spacing:.4px}
    .badge{font-size:12px;color:var(--muted);border:1px solid var(--ring);padding:4px 8px;border-radius:999px}
    .filters{display:flex;gap:8px;overflow:auto;padding:8px 0}
    .chip{background:var(--panel);color:var(--text);padding:8px 10px;border-radius:10px;border:1px solid var(--ring);font-size:13px;white-space:nowrap}
    .chip input, .chip select{background:transparent;border:none;color:inherit;font:inherit;outline:none}
    main{padding:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:10px}
    .tile{
      background:var(--tile);border:1px solid var(--ring);border-radius:14px;padding:10px;
      display:flex;flex-direction:column;gap:8px;min-height:140px;position:relative;overflow:hidden
    }
    .tile .sym{font-weight:700}
    .tile .meta{font-size:12px;color:var(--muted);display:flex;gap:8px;flex-wrap:wrap}
    .spark{height:36px;width:100%;}
    .score{position:absolute;right:8px;top:8px;font-size:12px;background:rgba(255,255,255,.06);border:1px solid var(--ring);padding:2px 6px;border-radius:999px}
    .hot{background: linear-gradient(90deg, rgba(255,92,92,.2), rgba(255,159,67,.2));}
    .warm{background: linear-gradient(90deg, rgba(255,159,67,.12), rgba(124,92,255,.10));}
    .cold{background: linear-gradient(90deg, rgba(108,140,255,.16), rgba(46,211,234,.14));}
    .pill{font-size:11px;padding:2px 6px;border-radius:999px;border:1px solid var(--ring);color:var(--muted)}
    .row-sb{display:flex;justify-content:space-between;gap:8px;align-items:center}
    .btn{
      background:var(--accent);color:white;border:none;border-radius:10px;padding:10px 12px;font-weight:700
    }
    .legend{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:12px}
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.hot{background:var(--hot)} .dot.warm{background:var(--warm)}
    .dot.cool{background:var(--cool)} .dot.cold{background:var(--cold)}
    .footer{color:var(--muted);font-size:12px;text-align:center;padding:24px}
    .drawer{position:fixed;inset:auto 0 0 0;background:var(--panel-2);border-top:1px solid var(--ring);transform:translateY(100%);transition:transform .25s;z-index:10}
    .drawer.open{transform:translateY(0)}
    .drawer .handle{width:36px;height:4px;background:#32405c;border-radius:999px;margin:8px auto}
    .drawer .content{padding:12px 12px 24px;max-height:60vh;overflow:auto}
    .pair-row{display:grid;grid-template-columns:1fr auto;gap:6px;font-size:14px;padding:6px 0;border-bottom:1px dashed #21304a}
    a { color: #9cb8ff; text-decoration: none; }
  </style>
</head>
<body>
<header>
  <div class="row">
    <div class="logo">HeatMap.AI</div>
    <div class="badge">Solana â€¢ Live</div>
    <div class="legend" style="margin-left:auto">
      <span class="dot cold"></span> Cold
      <span class="dot cool"></span> Cooling
      <span class="dot warm"></span> Warming
      <span class="dot hot"></span> Hot
    </div>
  </div>
  <div class="filters">
    <div class="chip">Min Liquidity: <select id="minLiq"><option value="0">Any</option><option value="10000">$10k</option><option value="25000">$25k</option><option value="50000">$50k</option></select></div>
    <div class="chip">Min 5m Vol: <select id="minVol"><option value="0">Any</option><option value="1000">$1k</option><option value="5000">$5k</option><option value="10000">$10k</option></select></div>
    <div class="chip">Age &lt; <select id="maxAge"><option value="999">Any</option><option value="24">24h</option><option value="6">6h</option><option value="2">2h</option></select></div>
    <div class="chip">New pairs only <input id="newOnly" type="checkbox"></div>
    <button class="btn" id="alertBtn">Set Hot Alert</button>
  </div>
</header>

<main>
  <div id="grid" class="grid"></div>
  <div class="footer">Prototype â€¢ No financial advice â€¢ Tap a tile for details</div>
</main>

<div id="drawer" class="drawer">
  <div class="handle"></div>
  <div class="content" id="drawerContent"></div>
</div>

<script>
// --- Data Provider: swap this to connect a real API ---
const Data = {
  subscribers:[],
  _tick:0,
  _pairs: [],
  subscribe(fn){ this.subscribers.push(fn) },
  notify(){ this.subscribers.forEach(fn=>fn(this._pairs)) },
  seed(n=40){
    const now=Date.now();
    function sym(){ const s='ABCDEFGHIJKLMNOPQRSTUVWXYZ'; return Array.from({length:4},()=>s[Math.floor(Math.random()*s.length)]).join('') }
    function name(){ const adj=['Turbo','Aqua','Meta','Giga','Nova','Shadow','Luna','Peak','Prime','Volt']; const n=['Coin','Swap','Cat','Dog','AI','Pad','Dex','Run','Core','Net']; 
      return adj[Math.floor(Math.random()*adj.length)]+' '+n[Math.floor(Math.random()*n.length)] }
    function spark(){ const a=[]; let v=100; for(let i=0;i<40;i++){ v += (Math.random()-0.5)*8; a.push(Math.max(60,Math.min(140,v))) } return a }
    this._pairs = Array.from({length:n}, (_,i)=>{
      const price5 = (Math.random()*14-7).toFixed(2);
      const vol5 = Math.floor(Math.random()*20000);
      const buys = Math.floor(Math.random()*300);
      const sells = Math.floor(Math.random()*300);
      const neww = Math.floor(Math.random()*200);
      const liq = 5000 + Math.floor(Math.random()*150000);
      const ageH = Math.floor(Math.random()*48);
      const score = z(price5,7) * .35 + z(vol5,20000)*.35 + z((buys/(sells+1)),1.5)*.15 + z(neww,200)*.15 - (liq<15000?0.6:0);
      return {
        id:'PAIR-'+i,
        symbol: sym(),
        name: name(),
        priceDelta5m: Number(price5),
        volume5m: vol5,
        buys5m: buys, sells5m: sells,
        newWallets30m: neww,
        liquidity: liq,
        ageHours: ageH,
        score: score,
        spark: spark(),
        url: 'https://dexscreener.com/'
      }
    });
    this.notify();
  },
  start(){
    setInterval(()=>{
      // drift values to simulate live
      this._tick++;
      this._pairs.forEach(p=>{
        const drift = (Math.random()-0.5)*2;
        p.priceDelta5m = Number((p.priceDelta5m + drift).toFixed(2));
        p.volume5m = Math.max(0, p.volume5m + Math.floor((Math.random()-0.5)*1500));
        p.buys5m = Math.max(0, p.buys5m + Math.floor((Math.random()-0.5)*40));
        p.sells5m = Math.max(0, p.sells5m + Math.floor((Math.random()-0.5)*40));
        p.newWallets30m = Math.max(0, p.newWallets30m + Math.floor((Math.random()-0.5)*20));
        p.score = z(p.priceDelta5m,7) * .35 + z(p.volume5m,20000)*.35 + z((p.buys5m/(p.sells5m+1)),1.5)*.15 + z(p.newWallets30m,200)*.15 - (p.liquidity<15000?0.6:0);
        // update sparkline
        p.spark.push( Math.max(60, Math.min(140, p.spark[p.spark.length-1] + (Math.random()-0.5)*6)) );
        if(p.spark.length>40) p.spark.shift();
      });
      this.notify();
    }, 5000);
  }
};
function z(value, maxAbs){ return Math.max(-1, Math.min(1, value / maxAbs)); }

// --- UI ---
const grid = document.getElementById('grid');
const drawer = document.getElementById('drawer');
const drawerContent = document.getElementById('drawerContent');

let filters = { minLiq:0, minVol:0, maxAge:999, newOnly:false };
let hotAlert = 0.8;

function colorClass(score){
  if(score>0.6) return 'hot';
  if(score>0.2) return 'warm';
  if(score>-0.2) return 'cool';
  return 'cold';
}

function fmtUSD(n){ return '$' + n.toLocaleString() }
function pct(n){ return (n>=0?'+':'') + n.toFixed(2) + '%' }

function render(pairs){
  const f = pairs
    .filter(p=>p.liquidity>=filters.minLiq)
    .filter(p=>p.volume5m>=filters.minVol)
    .filter(p=>p.ageHours<=filters.maxAge)
    .filter(p=>filters.newOnly ? p.ageHours<=2 : true)
    .sort((a,b)=>b.score - a.score);

  grid.innerHTML = '';
  f.forEach(p=>{
    const tile = document.createElement('div');
    tile.className = 'tile ' + colorClass(p.score);
    tile.innerHTML = `
      <div class="row-sb"><div class="sym">${p.symbol}</div><div class="score">${(p.score*100|0)}</div></div>
      <div class="meta">${p.name}</div>
      <canvas class="spark"></canvas>
      <div class="row" style="gap:6px;flex-wrap:wrap">
        <span class="pill">Î”5m: ${pct(p.priceDelta5m)}</span>
        <span class="pill">Vol5m: ${fmtUSD(p.volume5m)}</span>
        <span class="pill">Liq: ${fmtUSD(p.liquidity)}</span>
        <span class="pill">Age: ${p.ageHours}h</span>
      </div>
    `;
    tile.addEventListener('click', ()=>openDrawer(p));
    grid.appendChild(tile);
    drawSpark(tile.querySelector('canvas'), p.spark, p.priceDelta5m);
    if(p.score >= hotAlert){ notifyHot(p) }
  });
}

function drawSpark(canvas, data, delta){
  const ctx = canvas.getContext('2d');
  const w = canvas.clientWidth, h = canvas.clientHeight;
  canvas.width = w * devicePixelRatio; canvas.height = h * devicePixelRatio;
  ctx.scale(devicePixelRatio, devicePixelRatio);
  ctx.clearRect(0,0,w,h);
  ctx.lineWidth = 2;
  ctx.strokeStyle = delta>=0 ? '#14c184' : '#ff6b6b';
  const max = Math.max(...data), min = Math.min(...data);
  const xstep = w / (data.length-1);
  ctx.beginPath();
  data.forEach((v,i)=>{
    const x = i*xstep;
    const y = h - ((v-min)/(max-min+1e-6))*h;
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  });
  ctx.stroke();
}

function openDrawer(p){
  drawerContent.innerHTML = `
    <div class="row-sb">
      <div>
        <div style="font-weight:800">${p.symbol}</div>
        <div style="color:var(--muted);font-size:13px">${p.name}</div>
      </div>
      <a class="btn" href="${p.url}" target="_blank" rel="noopener">Trade</a>
    </div>
    <div style="margin:10px 0;border:1px solid var(--ring);border-radius:12px;padding:10px;background:var(--tile)">
      <canvas id="bigSpark" style="width:100%;height:80px"></canvas>
      <div class="row" style="gap:8px;margin-top:8px;flex-wrap:wrap">
        <span class="pill">Î”5m: ${pct(p.priceDelta5m)}</span>
        <span class="pill">Vol5m: ${fmtUSD(p.volume5m)}</span>
        <span class="pill">Buys:Sells ${p.buys5m}:${p.sells5m}</span>
        <span class="pill">New wallets: ${p.newWallets30m}</span>
        <span class="pill">Liquidity: ${fmtUSD(p.liquidity)}</span>
        <span class="pill">Age: ${p.ageHours}h</span>
        <span class="pill">Score: ${(p.score*100|0)}</span>
      </div>
    </div>
    <div style="font-weight:700;margin-top:8px">Similar pairs</div>
    <div id="similar"></div>
  `;
  drawSpark(document.getElementById('bigSpark'), p.spark, p.priceDelta5m);
  // naive similar list
  const sims = Data._pairs
    .filter(x=>x.id!==p.id)
    .sort((a,b)=>Math.abs(b.priceDelta5m-p.priceDelta5m)-Math.abs(a.priceDelta5m-p.priceDelta5m))
    .slice(0,5);
  const simEl = document.getElementById('similar');
  sims.forEach(s=>{
    const row = document.createElement('div');
    row.className = 'pair-row';
    row.innerHTML = `<div>${s.symbol} <span style="color:var(--muted)">${s.name}</span></div>
                     <div style="text-align:right">${pct(s.priceDelta5m)}</div>`;
    row.addEventListener('click', ()=>openDrawer(s));
    simEl.appendChild(row);
  });
  drawer.classList.add('open');
}
drawer.addEventListener('click', (e)=>{ if(e.target===drawer) drawer.classList.remove('open') });

// filters
document.getElementById('minLiq').addEventListener('change', e=>{ filters.minLiq=+e.target.value; render(Data._pairs) });
document.getElementById('minVol').addEventListener('change', e=>{ filters.minVol=+e.target.value; render(Data._pairs) });
document.getElementById('maxAge').addEventListener('change', e=>{ filters.maxAge=+e.target.value; render(Data._pairs) });
document.getElementById('newOnly').addEventListener('change', e=>{ filters.newOnly=e.target.checked; render(Data._pairs) });

const alertBtn = document.getElementById('alertBtn');
alertBtn.addEventListener('click', ()=>{
  const v = prompt('Alert when SCORE â‰¥ (0.0 - 1.0)', hotAlert.toString());
  if(v!==null){
    const num = parseFloat(v);
    if(!isNaN(num)){ hotAlert = Math.max(0, Math.min(1, num)); alert('Updated'); }
  }
});

function notifyHot(p){
  if(!('Notification' in window)) return;
  if(Notification.permission === 'granted'){
    new Notification('ðŸ”¥ Hot Pair', { body: `${p.symbol}: score ${(p.score*100|0)}` });
  } else if(Notification.permission !== 'denied'){
    Notification.requestPermission();
  }
}

Data.subscribe(render);
Data.seed(48);
Data.start();
</script>
</body>
</html>
